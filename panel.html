<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js";

  document.addEventListener("DOMContentLoaded", () => {

    // PANEL KORUMA
    const rumuz = localStorage.getItem("rumuz");
    if (!rumuz) {
      window.location.href = "index.html";
      return;
    }
    document.getElementById("welcome").innerText = rumuz + " hoÅŸ geldin";

    // ðŸ”§ FIREBASE CONFIG
    const firebaseConfig = {
      apiKey: "API_KEY",
      authDomain: "xxx.firebaseapp.com",
      projectId: "xxx",
      storageBucket: "xxx.appspot.com",
    };

    const app = initializeApp(firebaseConfig);
    const storage = getStorage(app);

    // âœ… BUTON ARTIK GERÃ‡EKTEN Ã‡ALIÅžIR
    document.getElementById("uploadBtn").addEventListener("click", async () => {
      const fileInput = document.getElementById("fileInput");
      const file = fileInput.files[0];

      if (!file) {
        alert("FotoÄŸraf seÃ§");
        return;
      }

      const fileRef = ref(
        storage,
        `photos/${rumuz}_${Date.now()}_${file.name}`
      );

      await uploadBytes(fileRef, file);
      const url = await getDownloadURL(fileRef);

      const img = document.createElement("img");
      img.src = url;
      document.getElementById("photos").prepend(img);

      fileInput.value = "";
    });

  });
</script>
